<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        /*
        Có một thông số về trạng thái pin tính bằng đơn vị số nguyên (tối đa 100 đv)
        Có một vùng nhớ dùng để lưu tin nhắn đang soạn thảo.
        Có một vùng nhớ dùng để lưu tin nhắn trong hộp thư đến.
        Có một vùng nhớ dùng để lưu tin nhắn đã gửi.

        Có chức năng kiểm tra trạng thái điện thoại bật hay tắt.
        Có chức năng bật và tắt điện thoại.
        Có chức năng xạc pin điện thoại.

        Có chức năng soạn tin nhắn.

        Có chức năng nhận tin nhắn từ một chiếc mobile khác. ?




        Có chức năng gửi tin nhắn tới một chiếc mobile khác. ?

        Có chức năng xem tin trong hộp thư đến.

        Có chức năng xem tin đã gửi.

        Sau mỗi lần sử dụng một chức năng, năng lượng pin sẽ giảm đi một đơn vị.
        Các chức năng không thể hoạt động nếu điện thoại chưa bật.
        */

        //status trạng thái on off
        function Mobile(pinStatus,status){
            this.pinStatus = pinStatus;
            this.messageMaking = "";//Lưu đang soạn
            this.messageInbox = [];//Thư đến
            this.messageSent = [];//Đã gửi
            this.status = status;
            if(!this.status){
                do {
                    let r = confirm("Your phone is turn OFF. Turn ON please!");
                    if(r==true){
                        this.status = true;
                        break;
                    }else{
                        alert("Please turn on your phone to use."); 
                    }
                } while(true);  
            }
           
            if(this.pinStatus > 100 || this.pinStatus < 0){
                alert("0<= Your battery <= 100%,please re-enter.");
                let x;
                do {
                    x = prompt("Enter the battery:");
                    if(Number.parseInt(x) && Number.parseInt(x) <=100){
                        this.pinStatus = Number.parseInt(x);
                        break;
                    }else{
                        alert("Your battery <= 100%,please re-enter.");
                    }
                } while (true);
            }

            this.statusPhone = function(){//Kiểm tra đang bật hay đang ko
                if(this.status){
                    return true;
                }else{
                    return false;
                }
                pinStatus --;
            }
            this.refillPin = function(energyAmount){//Kiểm tra pin
                if(this.pinStatus == 100){
                    alert("Your battery if full");
                }else{
                    this.pinStatus+=energyAmount;
                }
            }
            this.texting = function(messageMaking){//soạn tin nhắn
                this.messageMaking = messageMaking;
                pinStatus--;
            }
            this.getNamePhone = function(namePhone){
                return namePhone;
            }

            this.sendMessage = function (objectPhone,name,name1){ //Gửi tin nhắn
                let contentSend_ = {
                    content:this.messageMaking,
                    to:name
                }
               
                this.messageSent.push(contentSend_); //Đẩy tin nhắn đang soạn vào tn đã gửi
                objectPhone.getMessage(this.messageMaking,name1);//Đối tượng được gửi gọi lại hàm nhận của bản thân
                pinStatus--;
            }

            this.getMessage = function (messageInbox,name1){//Nhận tin nhắn
                let contentGet_ = {
                    content:this.messageMaking,
                    from:name1
                }
                this.messageInbox.push(contentGet_);
            }

            this.readIncomingMessage = function(){ // Đọc tin nhắn tới
                pinStatus--;
                for(let i =0;i<this.messageInbox.length;i++){
                    document.write("Tin nhắn "+i+":"+this.messageInbox[i]+"<br>");
                }
            }  
            this.readMessageSent = function(){ // Đọc tin nhắn đã gửi
                pinStatus--;
                for(let i =0;i<this.messageSent.length;i++){
                    document.write("Tin nhắn "+i+":"+this.messageSent[i]+"<br>");
                }
            }
                 
        }
        // Có một chiếc điện thoại nokia và một chiếc iphone
        // Chiếc điện thoại nokia soạn tin nhắn với nội dung bất kỳ và gửi cho chiếc iphoneChiếc iphone kiểm tra inbox và hiển thị tin đó
        let nokia = new Mobile(100,true);
        
        let apple = new Mobile(100,true);

        //soạn tin nhắn.
        let message = "Hello there.";
        // console.log(Object.keys({apple})[0]) 
        nokia.texting("Hello there.");
        let name = nokia.getNamePhone(Object.keys({apple})[0]);//Lấy ra tên đối tượng định gửi
        let name1 = nokia.getNamePhone(Object.keys({nokia})[0]);//Lấy ra tên đối tượng gửi
        console.log(name1);
        nokia.sendMessage(apple,name,name1);
        console.log(nokia.messageSent);
        console.log(apple.messageInbox);

    </script>
</body>
</html>